{% extends "../../layouts/master.njk" %}

{% block csslib %}
	<link href="/cms-static/admin/assets/plugins/custom/datatables/datatables.bundle.css" rel="stylesheet" type="text/css"/>
{% endblock %}

{% block jslib %}
	{# //- // begin::Vendors Javascript(used by this page) #}
	<script src='/cms-static/admin/assets/plugins/custom/datatables/datatables.bundle.js'></script>
	{# //- // end::Vendors Javascript #}
	{# //- // begin::Custom Javascript(used by this page) #}
	{# //- <script src='/cms-static/admin/assets/js/custom/apps/subscriptions/add/advanced.js'></script> #}
	{# //- <script src='/cms-static/admin/assets/js/custom/apps/subscriptions/add/customer-select.js'></script> #}
	{# //- <script src='/cms-static/admin/assets/js/custom/apps/subscriptions/add/products.js'></script> #}
	{# //- <script src='/cms-static/admin/assets/js/widgets.bundle.js'></script> #}
	{# //- <script src='/cms-static/admin/assets/js/custom/widgets.js'></script> #}

	<script src='/cms-static/admin/assets/js/custom/utilities/modals/create-app.js'></script>
	<script src='/cms-static/admin/assets/js/custom/utilities/modals/offer-a-deal/type.js'></script>
	<script src='/cms-static/admin/assets/js/custom/utilities/modals/offer-a-deal/details.js'></script>
	<script src='/cms-static/admin/assets/js/custom/utilities/modals/offer-a-deal/finance.js'></script>
	<script src='/cms-static/admin/assets/js/custom/utilities/modals/offer-a-deal/complete.js'></script>
	<script src='/cms-static/admin/assets/js/custom/utilities/modals/offer-a-deal/main.js'></script>
	<script src='/cms-static/admin/assets/plugins/custom/formrepeater/formrepeater.bundle.js'></script>
	{# //- // end::Custom Javascript #}

	<script src='/cms-static/common/js/form-data-json.min.js'></script>
	<script src='/cms-static/common/js/es-form.js'></script>
{% endblock %}

{% block customScript %}
	<script>
		$('#kt_docs_repeater_nested').repeater({
			repeaters: [
				{
					selector: '.inner-repeater',
					show: function () {
						$(this).slideDown();
					},

					hide: function (deleteElement) {
						$(this).slideUp(deleteElement);
					}
				}
			],

			show: function () {
				$(this).slideDown();
				// Re-init select2
				$(this)
					.find('[data-kt-repeate="select2"]')
					.select2();
			},

			hide: function (deleteElement) {
				$(this).slideUp(deleteElement);
			},
			ready: function () {
				// Init select2
				$('[data-kt-repeate="select2"]').select2();
			}
		});
	</script>

{% endblock %}

{% block content %}
	<div class="d-flex flex-column flex-column-fluid">
		<div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
			<div id="kt_app_toolbar_container" class="app-container container-xxl d-flex flex-stack">
				<div class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
					<h1 class="page-heading d-flex text-dark fw-bold fs-3 flex-column justify-content-center my-0">
						{{ contentType ? 'Edit' : 'Add' }} Content Type
				</h1>
					<ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
						<li class="breadcrumb-item text-muted">
							<a class="text-muted text-hover-primary" href="/admin/dashboard">Dashboard</a>
						</li>
						<li class="breadcrumb-item">
							<span class="bullet bg-gray-400 w-5px h-2px"></span>
						</li>
						<li class="breadcrumb-item text-muted">Content Type 
						<span class="bullet bg-gray-400 w-5px h-2px ms-1"></span>
						</li>
						<li class="breadcrumb-item text-muted">{{ contentType ? 'Edit' : 'New' }}</li>
					</ul>
				</div>
			</div>
		</div>
		<form id="kt_account_profile_details_form" class="form es-form" action="/admin/config/content-type/save" data-redirect-url="/admin/config/content-type" method="post" autocomplete="off">
			<div id="kt_app_content" class="app-content flex-column-fluid">
				<div id="kt_app_content_container" class="app-container container-xxl">

					<div class="card mb-5 mb-xl-10">
						<div class="card-header border-0 cursor-pointer" role="button" data-bs-toggle="collapse" data-bs-target="#kt_account_profile_details" aria-expanded="true" aria-controls="kt_account_profile_details">
							<div class="card-title m-0">
								<h3 class="fw-bold m-0">Content Type Form</h3>
							</div>
						</div>
						<div id="kt_account_settings_profile_details">
							<input type="hidden" name="id" value="{{ contentType ? contentType._id : '' }}">
							<div class="card-body border-top p-9">
								<div class="row mb-6">
									<label class="col-lg-4 col-form-label required fw-semibold fs-6">Title</label>
									<div class="col-lg-8">
										<div class="row">
											<div class="col-lg-12 fv-row">
												<input class="form-control form-control-lg form-control-solid mb-3 mb-lg-0" type="text" name="title" placeholder="Title" value="{{ contentType ? contentType.title : '' }}">
												<div class="fv-plugins-message-container invalid-feedback" id="field-error-title"></div>
											</div>
										</div>
									</div>
								</div>
								<div class="row mb-6">
									<label class="col-lg-4 col-form-label required fw-semibold fs-6">URL</label>
									<div class="col-lg-8 fv-row">
										<input class="form-control form-control-lg form-control-solid" type="text" name="slug" placeholder="URL" value="{{ contentType ? contentType.slug : '' }}">
										<div class="fv-plugins-message-container invalid-feedback" id="field-error-slug"></div>
									</div>
								</div>
								<div class="row mb-6">
									<label class="col-lg-4 col-form-label required fw-semibold fs-6">Single Type</label>
									<div class="col-lg-8 fv-row">
										<div class="form-check form-switch form-check-custom form-check-success form-check-solid">
											<input id="kt_flexSwitchCustomDefault_1_1" class="form-check-input" type="checkbox" name="single_type" value="true" {{ contentType && contentType.single_type ? 'checked' : '' }}>
											<label class="form-check-label" for="kt_flexSwitchCustomDefault_1_1"></label>
										</div>
										<div class="fv-plugins-message-container invalid-feedback" id="field-error-single_type"></div>
									</div>
								</div>

								<div class="row mb-6">
									<label class="col-lg-4 col-form-label required fw-semibold fs-6">Position</label>
									<div class="col-lg-8 fv-row">
										<input class="form-control form-control-lg form-control-solid" type="number" name="position" placeholder="Position" value="{{ contentType ? contentType.position : 0 }}">
										<div class="fv-plugins-message-container invalid-feedback" id="field-error-position"></div>
									</div>
								</div>

								<div class="row mb-6">
									<label class="col-lg-4 col-form-label required fw-semibold fs-6">Admin Icon (SVG Code)</label>
									<br>
									<a href="https://preview.keenthemes.com/html/metronic/docs/icons/duotune" target="_blank">
										<small>Sample Icons</small>
									</a>
									<div class="col-lg-8 fv-row">
										<textarea class="form-control form-control-lg form-control-solid" type="text" name="admin_icon" placeholder="Admin Icon">{{ contentType ? contentType.admin_icon : '' }}</textarea>
										<div class="fv-plugins-message-container invalid-feedback" id="field-error-admin_icon"></div>
									</div>
								</div>

								<div class="row mb-6">
									<label class="col-lg-4 col-form-label required fw-semibold fs-6">Attachable type</label>
									<div class="col-lg-8 fv-row">
										<select class="form-select form-select-lg form-select-solid" data-control="select2" data-close-on-select="false" name="attachable_type" data-placeholder="Select a type" data-allow-clear="true" multiple="multiple">
											{% for ct in contentTypes %}
												<option value="{{ ct.slug }}" {% if contentType and contentType.allowed_type and contentType.allowed_type.length and contentType.allowed_type.find((at)=>at==ct.slug) %}selected{% endif %}>{{ ct.title }}</option>
											{% endfor %}
										</select>
										<div class="fv-plugins-message-container invalid-feedback" id="field-error-attachable_type"></div>
									</div>
								</div>

							</div>
						</div>
					</div>

					<div class="card mb-5 mb-xl-10">
						<div class="card-header border-0 cursor-pointer" role="button" data-bs-toggle="collapse" data-bs-target="#kt_account_profile_details" aria-expanded="true" aria-controls="kt_account_profile_details">
							<div class="card-title m-0">
								<h3 class="fw-bold m-0">Features Checklist</h3>
							</div>
						</div>
						<div id="kt_account_settings_profile_details">
							<div class="card-body border-top p-9">
								<div class="row mb-6">
									<span class="col-lg-4 col-form-label required fw-semibold fs-6">Features Checklist</span>
									<small>Please include the following in your content type.</small>
									<div class="row mt-3">

										<div class="form-check form-check-custom form-check-solid form-check-sm col-md-4 mt-4">
											<input type="checkbox" value="true" name="has_slug" id="has_slug" {% if contentType %}checked="{{ contentType.has_slug }}"{% endif %}>
											<label for="has_slug">Has Slug (URL)</label>
										</div>
										<div class="form-check form-check-custom form-check-solid form-check-sm col-md-4 mt-4">
											<input type="checkbox" value="true" name="active" id="active" {% if contentType %}checked="{{ contentType.active }}"{% endif %}>
											<label for="active">Active</label>
										</div>
										<div class="form-check form-check-custom form-check-solid form-check-sm col-md-4 mt-4">
											<input type="checkbox" value="true" name="nav_on_collection_api" id="nav_on_collection_api" {% if contentType %}checked="{{ contentType.nav_on_collection_api }}"{% endif %}>
											<label for="nav_on_collection_api">Navigation On Collection API</label>
										</div>
										<div class="form-check form-check-custom form-check-solid form-check-sm col-md-4 mt-4">
											<input type="checkbox" value="true" name="nav_on_single_api" id="nav_on_single_api" {% if contentType %}checked="{{ contentType.nav_on_single_api }}"{% endif %}>
											<label for="nav_on_single_api">Navigation on Detail API</label>
										</div>
										<div class="form-check form-check-custom form-check-solid form-check-sm col-md-4 mt-4">
											<input type="checkbox" value="true" name="has_form" id="has_form" {% if contentType %}checked="{{ contentType.has_form }}"{% endif %}>
											<label for="has_form">Has Form</label>
										</div>
										<div class="form-check form-check-custom form-check-solid form-check-sm col-md-4 mt-4">
											<input type="checkbox" value="true" name="has_api_endpoint" id="has_api_endpoint" {% if contentType %}checked="{{ contentType.has_api_endpoint }}"{% endif %}>
											<label for="has_api_endpoint">Has API Endpoint</label>
										</div>
										<div class="form-check form-check-custom form-check-solid form-check-sm col-md-4 mt-4">
											<input type="checkbox" value="true" name="has_meta" id="has_meta" {% if contentType %}checked="{{ contentType.has_meta }}"{% endif %}>
											<label for="has_meta">Has Meta</label>
										</div>

									</div>
								</div>
							</div>

							<div class="card-footer d-flex justify-content-end py-6 px-9">
								<button class="btn btn-primary form-submit-btn" id="kt_account_profile_details_submit" type="submit">
									<span class="preloader d-none">Saving...</span>
									<span class="label">Save</span>
								</button>
							</div>
						</div>
					</div>

				</div>
			</div>
		</form>
	</div>

{% endblock %}