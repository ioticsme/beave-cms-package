extends ../../layouts/master.pug

block csslib
	link(href='/cms-static/admin/assets/plugins/custom/datatables/datatables.bundle.css' rel='stylesheet' type='text/css')

block jslib
	// begin::Vendors Javascript(used by this page)
	script(src='/cms-static/admin/assets/plugins/custom/datatables/datatables.bundle.js')
	// end::Vendors Javascript
	// begin::Custom Javascript(used by this page)
	//- script(src='/cms-static/admin/assets/js/custom/apps/subscriptions/add/advanced.js')
	//- script(src='/cms-static/admin/assets/js/custom/apps/subscriptions/add/customer-select.js')
	//- script(src='/cms-static/admin/assets/js/custom/apps/subscriptions/add/products.js')
	script(src='/cms-static/admin/assets/js/widgets.bundle.js')
	script(src='/cms-static/admin/assets/js/custom/widgets.js')
	script(src='/cms-static/admin/assets/js/custom/apps/chat/chat.js')
	script(src='/cms-static/admin/assets/js/custom/utilities/modals/upgrade-plan.js')
	script(src='/cms-static/admin/assets/js/custom/utilities/modals/create-app.js')
	script(src='/cms-static/admin/assets/js/custom/utilities/modals/offer-a-deal/type.js')
	script(src='/cms-static/admin/assets/js/custom/utilities/modals/offer-a-deal/details.js')
	script(src='/cms-static/admin/assets/js/custom/utilities/modals/offer-a-deal/finance.js')
	script(src='/cms-static/admin/assets/js/custom/utilities/modals/offer-a-deal/complete.js')
	script(src='/cms-static/admin/assets/js/custom/utilities/modals/offer-a-deal/main.js')
	script(src='/cms-static/admin/assets/plugins/custom/formrepeater/formrepeater.bundle.js')
	// end::Custom Javascript

	script(src='/cms-static/common/js/form-data-json.min.js')
	script(src='/cms-static/common/js/es-form.js')

block customScript
	script.
		$('#kt_docs_repeater_nested').repeater({
			repeaters: [{
				selector: '.inner-repeater',
				show: function () {
					$(this).slideDown();
				},

				hide: function (deleteElement) {
					$(this).slideUp(deleteElement);
				}
			}],

			show: function () {
				$(this).slideDown();
				// Re-init select2
				$(this).find('[data-kt-repeate="select2"]').select2();
			},

			hide: function (deleteElement) {
				$(this).slideUp(deleteElement);
			},
			ready: function(){
				// Init select2
				$('[data-kt-repeate="select2"]').select2();
			}
		});
block content
	.d-flex.flex-column.flex-column-fluid
		#kt_app_toolbar.app-toolbar.py-3.py-lg-6
			#kt_app_toolbar_container.app-container.container-xxl.d-flex.flex-stack
				.page-title.d-flex.flex-column.justify-content-center.flex-wrap.me-3
					h1.page-heading.d-flex.text-dark.fw-bold.fs-3.flex-column.justify-content-center.my-0
						| #{contentType ? 'Edit' : 'Add'} Content Type
					ul.breadcrumb.breadcrumb-separatorless.fw-semibold.fs-7.my-0.pt-1
						li.breadcrumb-item.text-muted
							a.text-muted.text-hover-primary(href='/admin/dashboard') Dashboard
						li.breadcrumb-item
							span.bullet.bg-gray-400.w-5px.h-2px
						li.breadcrumb-item.text-muted Content Type 
							span.bullet.bg-gray-400.w-5px.h-2px.ms-1
						li.breadcrumb-item.text-muted #{contentType ? 'Edit' : 'New'}
	form#kt_account_profile_details_form.form.es-form(action=`/admin/config/content-type/save` data-redirect-url=`/admin/config/content-type`  method='post' autocomplete="off")
		#kt_app_content.app-content.flex-column-fluid
			#kt_app_content_container.app-container.container-xxl
				.card.mb-5.mb-xl-10
					.card-header.border-0.cursor-pointer(role='button' data-bs-toggle='collapse' data-bs-target='#kt_account_profile_details' aria-expanded='true' aria-controls='kt_account_profile_details')
						.card-title.m-0
							h3.fw-bold.m-0 Content Type Form
						.card-toolbar 
							button#kt_account_profile_details_submit.btn.btn-primary.form-submit-btn(type='submit') 
								span.preloader.d-none
									| Saving...
								span.label
									| Save
					#kt_account_settings_profile_details.collapse.show
							input(type='hidden' name='id' value=`${contentType ? contentType._id : ''}`)
							.card-body.border-top.p-9
								.row.mb-6
									label.col-lg-4.col-form-label.required.fw-semibold.fs-6 Title
									.col-lg-8
										.row
											.col-lg-12.fv-row
												input.form-control.form-control-lg.form-control-solid.mb-3.mb-lg-0(type='text' name='title' placeholder='Title' value=`${contentType ? contentType.title : ''}`)
												.fv-plugins-message-container.invalid-feedback(id=`field-error-title`)
								.row.mb-6
									label.col-lg-4.col-form-label.required.fw-semibold.fs-6 URL
									.col-lg-8.fv-row
										input.form-control.form-control-lg.form-control-solid(type='text' name='slug' placeholder='URL' value=`${contentType ? contentType.slug : ''}`)
										.fv-plugins-message-container.invalid-feedback(id=`field-error-slug`)
								//- .row.mb-6
								//- 	label.col-lg-4.col-form-label.required.fw-semibold.fs-6 Template Name
								//- 	.col-lg-8.fv-row
								//- 		input.form-control.form-control-lg.form-control-solid(type='text' name='template_name' placeholder='Template Name' value=`${contentType ? contentType.template_name : ''}`)
								//- 		.fv-plugins-message-container.invalid-feedback(id=`field-error-template_name`)
								.row.mb-6
									label.col-lg-4.col-form-label.required.fw-semibold.fs-6 Position
									.col-lg-8.fv-row
										input.form-control.form-control-lg.form-control-solid(type='number' name='position' placeholder='Position' value=`${contentType ? contentType.position : 0}`)
										.fv-plugins-message-container.invalid-feedback(id=`field-error-position`)
								.row.mb-6
									label.col-lg-4.col-form-label.required.fw-semibold.fs-6 Admin Icon (SVG Code)
										br
										a(href='https://preview.keenthemes.com/html/metronic/docs/icons/duotune' target='_blank')
											small Sample Icons
									.col-lg-8.fv-row
										textarea.form-control.form-control-lg.form-control-solid(type='text' name='admin_icon' placeholder='Admin Icon' ) #{contentType ? contentType.admin_icon : ''}
										.fv-plugins-message-container.invalid-feedback(id=`field-error-admin_icon`)
								.row.mb-6
									label.col-lg-4.col-form-label.required.fw-semibold.fs-6 Attachable type
									.col-lg-8.fv-row
										select.form-select.form-select-lg.form-select-solid(data-control='select2' data-close-on-select='false' name='attachable_type' data-placeholder='Select a type' data-allow-clear='true' multiple='multiple')
											each ct in contentTypes
												option(value=`${ct.slug}` selected=contentType && contentType.allowed_type && contentType.allowed_type.length && contentType.allowed_type.find((at)=>at==ct.slug) ) #{ct.title}
										.fv-plugins-message-container.invalid-feedback(id=`field-error-attachable_type`)
				
				.ribbon.ribbon-start.ribbon-clip
					.ribbon-label
						| Custom Fields
						span.ribbon-inner.bg-success
				.card.mb-5.mb-xl-10
					.card-header.border-0.cursor-pointer(role='button' data-bs-toggle='collapse' data-bs-target='#kt_account_profile_details' aria-expanded='true' aria-controls='kt_account_profile_details')
						.card-title.m-0
							h3.fw-bold.m-0 Custom Fields
					#kt_account_settings_profile_details.collapse.show
							.card-body.border-top.p-9
								.row#kt_docs_repeater_nested
									if(contentType && contentType.custom_field_groups && contentType.custom_field_groups.length)
										.form-group.mt-10
											div(data-repeater-list='kt_docs_repeater_nested_outer')
												each cfg,i in contentType.custom_field_groups
													div(data-repeater-item='' style='background-color: #ebebeb').border.rounded.p-6.pt-12.mb-4.position-relative
														.position-absolute(style='top:10px; right:10px;')
															a.btn.btn-sm.btn-light-danger.border.border-danger.py-2.px-3(href='javascript:;' data-repeater-delete='')
																i.la.la-trash-o.fs-4
																| Delete Row
														.form-group.row.mb-5.mt-2
															.col-md-6
																label.form-label Row Label:
																input.form-control.form-control-solid.mb-2.mb-md-0(type='text' name="label" placeholder='Enter Row Label' value=`${cfg.row_label || ''}`)
															.col-md-6
																label.form-label Row Name:
																input.form-control.form-control-solid.mb-2.mb-md-0(type='text' name="name" placeholder='Enter Row name' value=`${cfg.row_name || ''}`)
															.col-md-6
																label.form-label Row Type:
																select.form-select.form-control.select2.form-select-lg.form-select-solid.mb-2.mb-md-0(name="repeater_group"  )
																	option(value="" ) Select Row type
																	option(value="false" selected=cfg && cfg.repeater_group == false) Normal
																	option(value="true" selected=cfg && cfg.repeater_group == true) Repeater
															.mt-2.col-md-6
																label.form-label Row Language type
																select.form-select.form-control.select2.form-select-lg.form-select-solid.mb-2(name="bilingual"  )
																	option(value="" ) Select language type
																	option(value="true" selected=cfg && cfg.bilingual == true) Bilingual
																	option(value="false" selected=cfg && cfg.bilingual == false) English Only
														//- hr
														div
															.inner-repeater
																.mb-5(data-repeater-list='kt_docs_repeater_nested_inner')
																	each cf,j in cfg.fields
																		div(data-repeater-item='').position-relative.border.rounded.p-6.pt-10.bg-white.mt-4
																			.position-absolute(style='top:10px; right:10px;')
																				button.btn-sm.btn.btn-light-danger.border.border-danger.py-2.px-3(data-repeater-delete='' type='button')
																					i.la.la-trash-o.fs-4
																					| Delete field
																			label.form-label Field:
																			.row
																				.mt-2.col-md-6
																					input.form-control.form-control-lg.form-control-solid(type='text' name='field_label' placeholder='Field Label' value=`${cf.field_label || ''}`)
																					.fv-plugins-message-container.invalid-feedback(id=`field-error-field_label`)
																				.mt-2.col-md-6
																					input.form-control.form-control-lg.form-control-solid(type='text' name='field_name' placeholder='Field Name' value=`${cf.field_name || ''}`)
																					.fv-plugins-message-container.invalid-feedback(id=`field-error-field_name`)
																				.mt-2.col-md-6
																					input.form-control.form-control-lg.form-control-solid(type='text' name='placeholder' placeholder='Placeholder' value=`${cf.placeholder || ''}`)
																					.fv-plugins-message-container.invalid-feedback(id=`field-error-placeholder`)
																				.mt-2.col-md-6
																					input.form-control.form-control-lg.form-control-solid(type='text' name='validation' placeholder='Validation' value=`${cf.validation || ''}`)
																					.fv-plugins-message-container.invalid-feedback(id=`field-error-validation`)

																				.mt-2.col-md-6
																					select.form-select.form-control.select2.form-select-lg.form-select-solid.mb-2(name="field_type" data-kt-repeater='select2' data-close-on-select='true' data-allow-clear="true" data-placeholder='Select field type' )
																						//- select.form-select.form-control.select2.form-select-lg.form-select-solid.mb-2(name="field_type" placeholder='Select field type' )
																						//- TODO::edit selection list item
																						option(value='') Select Field Type
																						option(value='text' selected=cf.field_type=='text') Text
																						option(value='wysiwig' selected=cf.field_type=='wysiwig') WYSIWYG
																						option(value='textarea' selected=cf.field_type=='textarea') Textarea
																						option(value='date' selected=cf.field_type=='date') Date
																						option(value='dropdown' selected=cf.field_type=='dropdown') Dropdown
																						option(value='radio' selected=cf.field_type=='radio') Radio
																						option(value='checkbox' selected=cf.field_type=='checkbox') Checkbox
																						option(value='file' selected=cf.field_type=='file') File
																				-var optionLabels = cf.options?.map((op)=>op.label)
																				-var optionValues = cf.options?.map((op)=>op.value)
																				.mt-2.col-md-6
																					textarea.form-control.form-control-lg.form-control-solid(type='text' name='option_label' placeholder='Dropdown option label seperated by comma(,)' ) #{optionLabels}
																					.fv-plugins-message-container.invalid-feedback(id=`field-error-option_label`)
																				.mt-2.col-md-6
																					textarea.form-control.form-control-lg.form-control-solid(type='text' name='option_value' placeholder='Dropdown option value seperated by comma(,)' ) #{optionValues}
																					.fv-plugins-message-container.invalid-feedback(id=`field-error-option_value`)
																				//- button.border.border-secondary.btn.btn-icon.btn-light-danger(data-repeater-delete='' type='button')
																				//- i.la.la-trash-o.fs-3
																			//- .text-center.mb-3.mt-2
																				button.btn-sm.btn.btn-light-danger(data-repeater-delete='' type='button')
																					i.la.la-trash-o.fs-3
																					| Delete field
																.text-center
																	button.btn.btn-sm.btn-light-primary.border.border-primary.py-2.px-3(data-repeater-create='' type='button')
																		i.la.la-plus
																		|  Add Field
															//- .text-center
																a.btn.btn-sm.btn-light-danger.mt-3.mt-md-9(href='javascript:;' data-repeater-delete='')
																	i.la.la-trash-o.fs-3
																	| Delete Row
											.form-group.mt-4.text-center
												a.btn.btn-sm.btn-light-primary.border.border-primary.py-2.px-3(href='javascript:;' data-repeater-create='')
													i.la.la-plus
													| Add Row			
									else
										//- Add Method
										.form-group.mt-10
											div(data-repeater-list='kt_docs_repeater_nested_outer')
												div(data-repeater-item='', style='background-color: #ebebeb').border.rounded.p-6.pt-12.mb-4.position-relative
													.position-absolute(style='top:10px; right:10px;')
														a.btn.btn-sm.btn-light-danger.border.border-danger.py-2.px-3(href='javascript:;' data-repeater-delete='')
															i.la.la-trash-o.fs-4
															| Delete Row
													.form-group.row.mb-5
														.col-md-6
															label.form-label Row Label:
															input.form-control.form-control-solid.mb-2.mb-md-0(type='text' name="label" placeholder='Enter Row Label')
														.col-md-6
															label.form-label Row Name:
															input.form-control.form-control-solid.mb-2.mb-md-0(type='text' name="name" placeholder='Enter Row name')
														.col-md-6
															label.form-label Row Type:
															select.form-select.form-control.select2.form-select-lg.form-select-solid.mb-2.mb-md-0(name="repeater_group" data-kt-repeater='select2' data-close-on-select='true' data-allow-clear="true" data-placeholder='Select row type' )
																//- select.form-select.form-control.select2.form-select-lg.form-select-solid.mb-2(name="bilingual[]" placeholder='Select language type' )
																//- TODO::edit selection list item
																option(value="" ) Select Row type
																option(value="false" selected=contentType && contentType.repeater_group == false) Normal
																option(value="true" selected=contentType && contentType.repeater_group == true) Repeater
														.mt-2.col-md-6
															label.form-label Row Language type
															select.form-select.form-control.select2.form-select-lg.form-select-solid.mb-2(name="bilingual" data-kt-repeater='select2' data-close-on-select='true' data-allow-clear="true" data-placeholder='Select language type' )
																//- select.form-select.form-control.select2.form-select-lg.form-select-solid.mb-2(name="bilingual[]" placeholder='Select language type' )
																//- TODO::edit selection list item
																option(value="" ) Select language type
																option(value="true" selected=contentType && contentType.bilingual == true) Bilingual
																option(value="false" selected=contentType && contentType.bilingual == false) English Only
													div
														.inner-repeater
															.mb-5(data-repeater-list='kt_docs_repeater_nested_inner')
																div(data-repeater-item='').position-relative.border.rounded.p-6.pt-10.bg-white.mt-4
																	.position-absolute(style='top:10px; right:10px;')
																		button.btn-sm.btn.btn-light-danger.border.border-danger.py-2.px-3(data-repeater-delete='' type='button')
																			i.la.la-trash-o.fs-4
																			| Delete field
																	label.form-label Field:
																	//- .input-group.pb-3
																	.row
																		//- input.form-control(type='text' name="number" placeholder='Enter contact number')
																		.mt-2.col-md-6
																			input.form-control.form-control-lg.form-control-solid(type='text' name='field_label' placeholder='Field Label' )
																			.fv-plugins-message-container.invalid-feedback(id=`field-error-field_label`)
																		.mt-2.col-md-6
																			input.form-control.form-control-lg.form-control-solid(type='text' name='field_name' placeholder='Field Name' )
																			.fv-plugins-message-container.invalid-feedback(id=`field-error-field_name`)
																		.mt-2.col-md-6
																			input.form-control.form-control-lg.form-control-solid(type='text' name='placeholder' placeholder='Placeholder' )
																			.fv-plugins-message-container.invalid-feedback(id=`field-error-placeholder`)
																		.mt-2.col-md-6
																			input.form-control.form-control-lg.form-control-solid(type='text' name='validation' placeholder='Validation' )
																			.fv-plugins-message-container.invalid-feedback(id=`field-error-validation`)

																		.mt-2.col-md-6
																			select.form-select.form-control.select2.form-select-lg.form-select-solid.mb-2(name="field_type" data-kt-repeater='select2' data-close-on-select='true' data-allow-clear="true" data-placeholder='Select field type' )
																				//- select.form-select.form-control.select2.form-select-lg.form-select-solid.mb-2(name="field_type" placeholder='Select field type' )
																				//- TODO::edit selection list item
																				option(value='') Select Field Type
																				option(value='text' ) Text
																				option(value='wysiwig' ) WYSIWYG
																				option(value='textarea' ) Textarea
																				option(value='date' ) Date
																				option(value='dropdown' ) Dropdown
																				option(value='radio' ) Radio
																				option(value='checkbox' ) Checkbox
																				option(value='file' ) File
																		.mt-2.col-md-6
																			textarea.form-control.form-control-lg.form-control-solid(type='text' name='option_label' placeholder='Dropdown option label seperated by comma(,)' )
																			.fv-plugins-message-container.invalid-feedback(id=`field-error-option_label`)
																		.mt-2.col-md-6
																			textarea.form-control.form-control-lg.form-control-solid(type='text' name='option_value' placeholder='Dropdown option value seperated by comma(,)' )
																			.fv-plugins-message-container.invalid-feedback(id=`field-error-option_value`)
																		//- button.border.border-secondary.btn.btn-icon.btn-light-danger(data-repeater-delete='' type='button')
																		//- i.la.la-trash-o.fs-3
																	
															.text-center
																button.btn.btn-sm.btn-light-primary.border.border-primary.py-2.px-3(data-repeater-create='' type='button')
																	i.la.la-plus
																	|  Add Field
														
										.form-group.mt-4.text-center
											a.btn.btn-sm.btn-light-primary.border.border-primary.py-2.px-3(href='javascript:;' data-repeater-create='')
												i.la.la-plus
												| Add Row
										// end::Form group
								
				.card.mb-5.mb-xl-10
					.card-header.border-0.cursor-pointer(role='button' data-bs-toggle='collapse' data-bs-target='#kt_account_profile_details' aria-expanded='true' aria-controls='kt_account_profile_details')
						.card-title.m-0
							h3.fw-bold.m-0 Features Checklist
					#kt_account_settings_profile_details.collapse.show
							.card-body.border-top.p-9
								.row.mb-6
									span.col-lg-4.col-form-label.required.fw-semibold.fs-6 Features Checklist
									small Please include the following in your content type.
									.row.mt-3
										.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
											input#in_use.form-check-input(type='checkbox' value='true' name='in_use' checked=(contentType ? contentType.in_use : false))
											label.form-check-label(for='in_use') In Use
										.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
											input#has_banner.form-check-input(type='checkbox' value='true' name='has_banner' checked=(contentType ? contentType.has_banner : false))
											label.form-check-label(for='has_banner') Has Banner
										.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
											input#has_gallery.form-check-input(type='checkbox' value='true' name='has_gallery' checked=(contentType ? contentType.has_gallery : false))
											label.form-check-label(for='has_gallery') Has Gallery
										.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
											input#has_form.form-check-input(type='checkbox' value='true' name='has_form' checked=(contentType ? contentType.has_form : false))
											label.form-check-label(for='has_form') Has Form
										.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
											input#has_api_endpoint.form-check-input(type='checkbox' value='true' name='has_api_endpoint' checked=(contentType ? contentType.has_api_endpoint : false))
											label.form-check-label(for='has_api_endpoint') Has API Endpoint
										.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
											input#hide_title.form-check-input(type='checkbox' value='true' name='hide_title' checked=(contentType ? contentType.hide_title : false))
											label.form-check-label(for='hide_title') Hide Title
										.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
											input#hide_body.form-check-input(type='checkbox' value='true' name='hide_body' checked=(contentType ? contentType.hide_body : false))
											label.form-check-label(for='hide_body') Hide Body
										.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
											input#hide_excerpt.form-check-input(type='checkbox' value='true' name='hide_excerpt' checked=(contentType ? contentType.hide_excerpt : false))
											label.form-check-label(for='hide_excerpt') Hide Excerpt
										.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
											input#hide_meta.form-check-input(type='checkbox' value='true' name='hide_meta' checked=(contentType ? contentType.hide_meta : false))
											label.form-check-label(for='hide_meta') Hide Meta

							.card-footer.d-flex.justify-content-end.py-6.px-9
								