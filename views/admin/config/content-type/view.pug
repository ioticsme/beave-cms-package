extends ../../layouts/master.pug

block csslib
	link(href='/cms-static/admin/assets/plugins/custom/datatables/datatables.bundle.css' rel='stylesheet' type='text/css')

block jslib
	// begin::Vendors Javascript(used by this page)
	script(src='/cms-static/admin/assets/plugins/custom/datatables/datatables.bundle.js')
	// end::Vendors Javascript
	// begin::Custom Javascript(used by this page)
	script(src='/cms-static/admin/assets/js/widgets.bundle.js')
	script(src='/cms-static/admin/assets/js/custom/widgets.js')
	//- script(src='/cms-static/admin/assets/js/custom/utilities/modals/offer-a-deal/main.js')
	script(src='https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js')
	script(src='https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js')
	// end::Custom Javascript

	script(src='/cms-static/common/js/field-generator.js')
	script(src='/cms-static/common/js/form-data-json.min.js')
	script(src='/cms-static/common/js/es-form.js')

block customScript
	script.
		document.addEventListener('DOMContentLoaded', function () {
			//- console.log('#{fields_to_map}')
			//- alert('ss')
			console.log(`#{fields_to_map[0].section}`);
			fields_to_map.forEach(function(jsonObject) {
				console.log(jsonObject);
			});

			//- console.log(fieldSchemaJson.)
			//- var bkupDataJson = _.cloneDeep(fieldSchemaJson)
			//- generateField()
		})

block content
	.d-flex.flex-column.flex-column-fluid
		#kt_app_toolbar.app-toolbar.py-3.py-lg-6
			#kt_app_toolbar_container.app-container.container-xxl.d-flex.flex-stack
				.page-title.d-flex.flex-column.justify-content-center.flex-wrap.me-3
					h1.page-heading.d-flex.text-dark.fw-bold.fs-3.flex-column.justify-content-center.my-0
						| Content Type Details #{fields_to_map[0].section}
					ul.breadcrumb.breadcrumb-separatorless.fw-semibold.fs-7.my-0.pt-1
						li.breadcrumb-item.text-muted
							a.text-muted.text-hover-primary(href='/admin/dashboard') Dashboard
						li.breadcrumb-item
							span.bullet.bg-gray-400.w-5px.h-2px
						li.breadcrumb-item.text-muted Content Type 
							span.bullet.bg-gray-400.w-5px.h-2px.ms-1
						li.breadcrumb-item.text-muted #{contentType ? 'Edit' : 'New'}
				.d-flex.align-items-center.gap-2.gap-lg-3
					a.btn.btn-sm.fw-bold.btn-primary(data-bs-toggle="modal" data-bs-target="#field_section_form_modal") Add Field Section
					a.btn.btn-sm.fw-bold.btn-primary(href=`/admin/config/content-type/edit/${contentType._id}`) Edit
		#kt_app_content.app-content.flex-column-fluid
			#kt_app_content_container.app-container.container-xxl
				.row
					.col-3
						ul.nav.nav-tabs.nav-pills.flex-row.border-0.flex-md-column.me-5.mb-3.mb-md-0.fs-6.min-w-lg-200px
							li.nav-item.w-100.me-0.mb-md-2
								a.nav-link.w-100.active.btn.btn-flex.btn-active-light-success.active(data-bs-toggle='tab' href='#kt_vtab_pane_4')
									span.svg-icon.svg-icon-2
										svg(width='24' height='24' viewbox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg')
											path(opacity='0.3' d='M22.1 11.5V12.6C22.1 13.2 21.7 13.6 21.2 13.7L19.9 13.9C19.7 14.7 19.4 15.5 18.9 16.2L19.7 17.2999C20 17.6999 20 18.3999 19.6 18.7999L18.8 19.6C18.4 20 17.8 20 17.3 19.7L16.2 18.9C15.5 19.3 14.7 19.7 13.9 19.9L13.7 21.2C13.6 21.7 13.1 22.1 12.6 22.1H11.5C10.9 22.1 10.5 21.7 10.4 21.2L10.2 19.9C9.4 19.7 8.6 19.4 7.9 18.9L6.8 19.7C6.4 20 5.7 20 5.3 19.6L4.5 18.7999C4.1 18.3999 4.1 17.7999 4.4 17.2999L5.2 16.2C4.8 15.5 4.4 14.7 4.2 13.9L2.9 13.7C2.4 13.6 2 13.1 2 12.6V11.5C2 10.9 2.4 10.5 2.9 10.4L4.2 10.2C4.4 9.39995 4.7 8.60002 5.2 7.90002L4.4 6.79993C4.1 6.39993 4.1 5.69993 4.5 5.29993L5.3 4.5C5.7 4.1 6.3 4.10002 6.8 4.40002L7.9 5.19995C8.6 4.79995 9.4 4.39995 10.2 4.19995L10.4 2.90002C10.5 2.40002 11 2 11.5 2H12.6C13.2 2 13.6 2.40002 13.7 2.90002L13.9 4.19995C14.7 4.39995 15.5 4.69995 16.2 5.19995L17.3 4.40002C17.7 4.10002 18.4 4.1 18.8 4.5L19.6 5.29993C20 5.69993 20 6.29993 19.7 6.79993L18.9 7.90002C19.3 8.60002 19.7 9.39995 19.9 10.2L21.2 10.4C21.7 10.5 22.1 11 22.1 11.5ZM12.1 8.59998C10.2 8.59998 8.6 10.2 8.6 12.1C8.6 14 10.2 15.6 12.1 15.6C14 15.6 15.6 14 15.6 12.1C15.6 10.2 14 8.59998 12.1 8.59998Z' fill='currentColor')
											path(d='M17.1 12.1C17.1 14.9 14.9 17.1 12.1 17.1C9.30001 17.1 7.10001 14.9 7.10001 12.1C7.10001 9.29998 9.30001 7.09998 12.1 7.09998C14.9 7.09998 17.1 9.29998 17.1 12.1ZM12.1 10.1C11 10.1 10.1 11 10.1 12.1C10.1 13.2 11 14.1 12.1 14.1C13.2 14.1 14.1 13.2 14.1 12.1C14.1 11 13.2 10.1 12.1 10.1Z' fill='currentColor')
									span.d-flex.flex-column.align-items-start
										span.fs-4.fw-bold Fields
										span.fs-7 Description
							li.nav-item.w-100.me-0.mb-md-2
								a.nav-link.w-100.btn.btn-flex.btn-active-light-info(data-bs-toggle='tab' href='#kt_vtab_pane_5')
									span.svg-icon.svg-icon-2
										svg(width='24' height='24' viewbox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg')
											path(opacity='0.3' d='M22.1 11.5V12.6C22.1 13.2 21.7 13.6 21.2 13.7L19.9 13.9C19.7 14.7 19.4 15.5 18.9 16.2L19.7 17.2999C20 17.6999 20 18.3999 19.6 18.7999L18.8 19.6C18.4 20 17.8 20 17.3 19.7L16.2 18.9C15.5 19.3 14.7 19.7 13.9 19.9L13.7 21.2C13.6 21.7 13.1 22.1 12.6 22.1H11.5C10.9 22.1 10.5 21.7 10.4 21.2L10.2 19.9C9.4 19.7 8.6 19.4 7.9 18.9L6.8 19.7C6.4 20 5.7 20 5.3 19.6L4.5 18.7999C4.1 18.3999 4.1 17.7999 4.4 17.2999L5.2 16.2C4.8 15.5 4.4 14.7 4.2 13.9L2.9 13.7C2.4 13.6 2 13.1 2 12.6V11.5C2 10.9 2.4 10.5 2.9 10.4L4.2 10.2C4.4 9.39995 4.7 8.60002 5.2 7.90002L4.4 6.79993C4.1 6.39993 4.1 5.69993 4.5 5.29993L5.3 4.5C5.7 4.1 6.3 4.10002 6.8 4.40002L7.9 5.19995C8.6 4.79995 9.4 4.39995 10.2 4.19995L10.4 2.90002C10.5 2.40002 11 2 11.5 2H12.6C13.2 2 13.6 2.40002 13.7 2.90002L13.9 4.19995C14.7 4.39995 15.5 4.69995 16.2 5.19995L17.3 4.40002C17.7 4.10002 18.4 4.1 18.8 4.5L19.6 5.29993C20 5.69993 20 6.29993 19.7 6.79993L18.9 7.90002C19.3 8.60002 19.7 9.39995 19.9 10.2L21.2 10.4C21.7 10.5 22.1 11 22.1 11.5ZM12.1 8.59998C10.2 8.59998 8.6 10.2 8.6 12.1C8.6 14 10.2 15.6 12.1 15.6C14 15.6 15.6 14 15.6 12.1C15.6 10.2 14 8.59998 12.1 8.59998Z' fill='currentColor')
											path(d='M17.1 12.1C17.1 14.9 14.9 17.1 12.1 17.1C9.30001 17.1 7.10001 14.9 7.10001 12.1C7.10001 9.29998 9.30001 7.09998 12.1 7.09998C14.9 7.09998 17.1 9.29998 17.1 12.1ZM12.1 10.1C11 10.1 10.1 11 10.1 12.1C10.1 13.2 11 14.1 12.1 14.1C13.2 14.1 14.1 13.2 14.1 12.1C14.1 11 13.2 10.1 12.1 10.1Z' fill='currentColor')
									span.d-flex.flex-column.align-items-start
										span.fs-4.fw-bold Config
										span.fs-7 Description
					.col-9
						#myTabContent.tab-content
							#kt_vtab_pane_4.tab-pane.fade.show.active(role="tabpanel")
								.card.mb-5.mb-xl-10
									.card-header.border-0.cursor-pointer(role='button' data-bs-toggle='collapse' data-bs-target='#kt_account_profile_details' aria-expanded='true' aria-controls='kt_account_profile_details')
										.card-title.m-0
											h3.fw-bold.m-0 Content Fields
										.card-toolbar.pt-5
											button.btn.btn-sm.btn-success(type='button' disabled=true id="schema-save-btn")
												i.las.la-save
												| Save
									input(type='hidden' name='id' value=`${contentType ? contentType._id : ''}`)
									.card-body.border-top.p-9
										.form-field-holder
							#kt_vtab_pane_5.tab-pane.fade(role="tabpanel")
								.card.mb-5.mb-xl-10
									.card-header.border-0.cursor-pointer(role='button' data-bs-toggle='collapse' data-bs-target='#kt_account_profile_details' aria-expanded='true' aria-controls='kt_account_profile_details')
										.card-title.m-0
											h3.fw-bold.m-0 Content Type
									#kt_account_settings_profile_details.collapse.show
										.card-body.border-top.p-9
											.row.mb-6
												label.col-lg-4.col-form-label.required.fw-semibold.fs-6 Title
												.col-lg-8.pt-2 #{contentType.title}
											.row.mb-6
												label.col-lg-4.col-form-label.required.fw-semibold.fs-6 URL
												.col-lg-8.pt-2 #{contentType.slug}
											.row.mb-6
												label.col-lg-4.col-form-label.required.fw-semibold.fs-6 Position
												.col-lg-8.pt-2 #{contentType.position}
											.row.mb-6
												label.col-lg-4.col-form-label.required.fw-semibold.fs-6 Admin Icon (SVG Code)
												.col-lg-8.pt-2
													span.svg-icon.svg-icon-muted.svg-icon-2hx !{contentType.admin_icon}
											.row.mb-6
												label.col-lg-4.col-form-label.required.fw-semibold.fs-6 Attachable type
												.col-lg-8.pt-2
													if contentType.allowed_type
														each ct in contentType.allowed_type
															span.badge.badge-dark.mr-1 #{ct}

								//- include field-config-form	

								.card.mb-5.mb-xl-10
									.card-header.border-0.cursor-pointer(role='button' data-bs-toggle='collapse' data-bs-target='#kt_account_profile_details' aria-expanded='true' aria-controls='kt_account_profile_details')
										.card-title.m-0
											h3.fw-bold.m-0 Features
									#kt_account_settings_profile_details.collapse.show
										.card-body.border-top.p-9
											.row.mb-6
												.row.mt-3
													.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
														input#in_use.form-check-input(type='checkbox' value='true' disabled='true' name='in_use' checked=(contentType ? contentType.in_use : false))
														label.form-check-label(for='in_use') In Use
													.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
														input#has_banner.form-check-input(type='checkbox' value='true' disabled='true' name='nav_on_collection_api' checked=(contentType ? contentType.nav_on_collection_api : false))
														label.form-check-label(for='nav_on_collection_api') Navigation On Collection API
													.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
														input#has_gallery.form-check-input(type='checkbox' value='true' disabled='true' name='nav_on_single_api' checked=(contentType ? contentType.nav_on_single_api : false))
														label.form-check-label(for='nav_on_single_api') Navigation on Detail API
													.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
														input#has_form.form-check-input(type='checkbox' value='true' disabled='true' name='has_form' checked=(contentType ? contentType.has_form : false))
														label.form-check-label(for='has_form') Has Form
													.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
														input#has_api_endpoint.form-check-input(type='checkbox' value='true' disabled='true' name='has_api_endpoint' checked=(contentType ? contentType.has_api_endpoint : false))
														label.form-check-label(for='has_api_endpoint') Has API Endpoint
													.form-check.form-check-custom.form-check-solid.form-check-sm.col-md-4.mt-4
														input#hide_meta.form-check-input(type='checkbox' value='true' disabled='true' name='hide_meta' checked=(contentType ? contentType.hide_meta : false))
														label.form-check-label(for='hide_meta') Hide Meta


block widgets
	#field_section_form_modal.modal.fade(tabindex='-1')
		.modal-dialog.modal-dialog-centered
			.modal-content
				form(id="field-section-form")
					.modal-header
						h3.modal-title Add Field Section
						// begin::Close
						.btn.btn-icon.btn-sm.btn-active-light-primary.ms-2(data-bs-dismiss='modal' aria-label='Close')
						span.svg-icon.svg-icon-1
						// end::Close
					.modal-body
						input(type="text" name="section_name" id="section_name" class="form-control" placeholder="Field Section Name")
						.form-check.form-check-custom.form-check-solid.mt-5
							input#section_repeater.form-check-input(type='checkbox')
							label.form-check-label(for='flexCheckChecked')
								| Repeater
					.modal-footer
						button.btn.btn-light(type='reset' data-bs-dismiss='modal') Close
						button.btn.btn-primary(type='submit') Add Section
	#field_form_modal.modal.fade(tabindex='-1')
		.modal-dialog.modal-dialog-centered
			.modal-content
				.modal-header
					h3.modal-title Add Field
					// begin::Close
					.btn.btn-icon.btn-sm.btn-active-light-primary.ms-2(data-bs-dismiss='modal' aria-label='Close')
					span.svg-icon.svg-icon-1
					// end::Close
				.modal-body
					#field-list-section.modal-field-sections
						a.btn.btn-primary.m-1(href='#' data-value="text")
							i.bi.bi-chat-square-text-fill.fs-4.me-2
							|  Text
						a.btn.btn-secondary.m-1(href='#' data-value="email")
							i.bi.bi-chat-square-text-fill.fs-4.me-2
							|  Email
						a.btn.btn-success.m-1(href='#')
							i.bi.bi-chat-square-text-fill.fs-4.me-2
							|  Number
						a.btn.btn-info.m-1(href='#')
							i.bi.bi-chat-square-text-fill.fs-4.me-2
							|  Textarea
						a.btn.btn-warning.m-1(href='#')
							i.bi.bi-chat-square-text-fill.fs-4.me-2
							|  Rich Text
						a.btn.btn-danger.m-1(href='#')
							i.bi.bi-chat-square-text-fill.fs-4.me-2
							|  Radio
						a.btn.btn-dark.m-1(href='#')
							i.bi.bi-chat-square-text-fill.fs-4.me-2
							|  Dropdown
					#text-field-section.modal-field-sections.d-none
						form(class="field-form")
							input(type="hidden" name="section_name_field" class="section_name_field")
							input(type="hidden" name="field_type" value="text")
							input(type="text" name="field_name" id="field_name" class="form-control" placeholder="Field Name")
							.form-check.form-check-custom.form-check-solid
								input#flexRadioDefault.form-check-input(type='radio' value='')
								label.form-check-label(for='flexRadioDefault')
									| Text
								input#flexRadioDefault.form-check-input(type='radio' value='')
								label.form-check-label(for='flexRadioDefault')
									| Email
							.row.mt-5
								.col-12
									button.btn.btn-light(type='reset' data-bs-dismiss='modal') Back
									button.btn.btn-primary(type='submit') Add Field
					#email-field-section.modal-field-sections.d-none
						form(class="field-form")
							input(type="hidden" name="section_name_field" class="section_name_field")
							input(type="hidden" name="field_type" value="email")
							input(type="text" name="field_name" id="field_name" class="form-control" placeholder="Field Name")
							.form-check.form-check-custom.form-check-solid.mt-5
								input#flexRadioDefault.form-check-input(type='checkbox' value='')
								label.form-check-label(for='flexRadioDefault')
									| Required
							.row.mt-5
								.col-12
									button.btn.btn-light(type='reset' data-bs-dismiss='modal') Back
									button.btn.btn-primary(type='submit') Add Field
